# Test_task
Тестовое задание Everypixel
## Текст задания
### Hipster Dogs vs Hipster Cats.
&nbsp;&nbsp;&nbsp; Подготовить выборку из популярных фотографий котов и собак с сайта stocksy.com: поиск осуществлять по тегам cat и dog, объем - по 1000 экземпляров на каждый из двух классов в качестве обучающей выборки и по 400 экземпляров на каждый класс в качестве валидационной выборки. Выбрать и обучить модель классификатора, дающую accuracy на валидационной выборке не ниже 0.8. Предоставить код по сбору данных и по обучению модели (можно на github). Предложить варианты по повышению точности работы классификатора. Рекомендуемый к использованию язык программирования: python.

## 1) Подготовка выборки
&nbsp;&nbsp;&nbsp; На данном этапе нужно было скачать фотографии с сайта stocksy.com. Для этой цели я решила использовать Scrapy, удобный фреймворк для сбора данных.  
&nbsp;&nbsp;&nbsp; Изучив запросы отправляемые на сайт при запуске поиска можно заметить, что производить выборку фотографий с сайта по тегу можно посредством запоса в формате json определенного формата, и увидеть какая именно информация приходит в ответ на такой запрос.  
&nbsp;&nbsp;&nbsp; Так как для построения классификатора будет использоваться достаточно маленькая выборка (1000 объектов на класс) для нас очень важно, чтобы выдача по нашему запросу была максимально чистой. Поэксперементировав с запросом и пробежавшись глазами по выдаче я определила такие основные проблемы: 
* часто в выдаче по тегу "cat" попадают дикие животные из семейства кошачих
* много людей на фотографиях
* на фото и собака и кот одновременно 

&nbsp;&nbsp;&nbsp; Все это может отражаться на качестве классификатора, поэтому я модифицировала запрос. Теперь по при поиске по одному тегу второй исключается из запроса, так же исключаются теги wild, wildlife (дикие животные не попадают в выдачу) и теги people, women, child, girl, boy, face, female, men (становится намного меньше фотографий, где в центре композиции находятся люди).   
&nbsp;&nbsp;&nbsp; В итоге было решено посылать запрос в формате "https://www.stocksy.com/search/query?format=json&filters={"text":"%s+pet+-wild+-wildlife+-%s+-people+-women+-child+-girl+-boy+-face+-female+-men","modelreleaseCount":["0"],"searchAccess":"public","assetType":["photo_creative"],"anonymousPeople":"false"}&"sort"="popular"&pageSize=%d"
%s в этом пути заменяется на "cat" и "dog" соответственно в зависимости от того какие фотографии качаются в данный момент. %d на количество фотографий, которые необходимо скачать. (В нашем случае 1400). Выдача по такому запросу выглядит достаточно чистой.  
&nbsp;&nbsp;&nbsp; Настраиваю парсер с помощью Scrapy и запускаю его из командной строки с помощью команды  
* scrapy runspider <имя файла с кодом>

Код для сбора данных [no_people_no_wild.py]()

## 2) Дообучение предобученной сети

Попробуем дообучить последний слой 
